# -*- coding: utf-8 -*-
"""
Created on Fri Sep  8 11:55:32 2017

@author: ASUS
This code snippet finds the consensus and profile of DNA sequences
"""

#I put '\n' manually so that it fits to my program
string = ">Rosalind_8793\nCGGTAGTACGGCTTGTAAACCTTATGTTGAGTCTGAGTGTGCTCAAACCACCCACTCATGGTCACGCGGGTCCTAGACGAGGTGGTCACACATCTTTAATCGTCGCAAAACCGTTCGTACACGCCTCCCAACGAAAGTCCTATACACCTCGAGGCTTTATAAAGAAGTGGATTGCTCAACGTGAAGGGCGAAGGCTCAATTTGGATTCCAGTTTGTGATCATGACGTGGGCAGGGTATCGGTACACCTACCCGCATCCTCATATCCCTCCAGCTACCGACTAGTGTGTCCGGATGTGTCATCGGCGAGGCCTGACTGCGTGTTGGATCGGGTACCTGTGATTGAACAACGACAACCGAGAGTAGCGGCGAGCTGTCTGAAGGAGCCCGTTCACGGGAACTACTGTAGGGAGCAGATGCAACTACTTATTATTCACCAACGGCTTTCGCCGAGCCTCACCGGCTCAGCATTCCCCATACTGGAGGCGTGAACGCCGGCATTAGGCGCAATAAAAGTCCGCAGAGCTGACAACAGCCGAGTGACAATATGCAGGGTCCTGGTGCATTCCCCACCTCATATAGCGCAAGACATACGGAATTATTTGGCGGGGACATAAGTTCTGCTTCCGAAGATAAAGTCCAGTAAATCTAGGCTCCAAAAATTGGTTGCCGACCGATCCCCGTCGATGAAGAGGTAGCCCATGAGAGAGGTGGTTTTAAGTCCCCCTTGTACGAGTAAACACCCTTATTAACCCAGTTAGCGCCTCAAAGAGAATGATGTTATTGCGATAAAAATTTTACTCAAAAAACCACCAAGATTCCACGCGACGGTCGCCATTTAGGGCACCAGACGCAATAGGATTCGTGCCGAGACGTTTCTTAGAATTGTTAAACAGATTGTCGGGAAACCCATGGAGAACCCCGCTATTCTCTATGACGAGGCTTATCCTTAGCCATTGCGCGCGACATGGAGTGAGCGCGGGAA\n>Rosalind_3567\nCGCGCAGTTACATGGGGTAAGCTCCCAGTGCTGTGCTCGGCGCTGGTTAATAACGTATCCCCGGCGAATCTCAGCGACAGCAACACCCACATGTCCCGCGACCCTTCTTACGAGCGGTGCTGTCATCATAGCCCTAGTTCGTGCACAGACAGGCGGTTGGCATATCGCCTCAGCCCCTGAAAAGCGCGATCCTGCTCTCCAGCGCGCACAACGCATATAGCCTGGATAATGAGGAGGATGCTACACAAGCAAAGGTTCTTTCTAGGGAAGTCCCTCGGCGCACCGCCTAGTGATCCCCTTTTACTGCACCACGGCTAATGCTTGTGGACTAGGGTAAACCTCGTATAGCGTCCCCTATAAGCCGGACCGGGTGTATTTGCTCCAACCCGTATGAAGATACAGCAGCATTTTCGTGACCGTTATTCGCGGAGTGCCGCGCGCTCCTTAGGAAGACCGGGCAGTGATCAAGGCCTGACAAAAAAAGGCCACCCATAGTTCCCTCCGCGTCGCCCACGCTGAGTGTTGGAGTGGAGGGATTCCTTAATGACCCTAATCATATTACGAATCAGTATCCACAGTAAGTGGGAATGTGTCTTCGGACGCTTCTAAGCGCCGCCATGATGATAGTACTGTCTCCCCCAAGCGGGGAGACTGCTATCTAACATAAGTATGTACACCGGATGCCCGCAAACGTCTACCAGCTGTCTTGAAGAGCAGACGCCAGATTTCAGTGTGTGCAACAGGTCGTTTGCAACCGATGCCATCTGATAATCGGCCCGGGTGCGGATAACCTGAATCGGCAAGCCCGATTCTCTTCCCAAAGTATGTACTTTCCGATTACCAGGTTACAGGGTGGAGTCCGATAGCTAGGAAAGAAACAGTATCGTGTCAGTAGGTAGCCACCCGGCCTGGCATCTAGTGTCGATGCCGCTTTCTTGCTTACATATTGCCTCAAACATCACAGAGGGGCACAACACGTTAAA\n>Rosalind_7731\nAAGGAGATGATTTTATTCACGTGGACTCTACGGCGGAAATAACCGCGCGACCGATCCCCGAGTGTACCTACGAAGTCAGATCTATGACTGAGGATGACGCTCTATCGGTTGTACTACGGACACCGAAGCATTAACTGAAGTCGCCGTTTGTCGCGAATCGTCGCACCCCCCTCGATGACGAGACGTCGAAACATTGATGGTTGGTCCGTTTAATCGAACGAACGCGTGCGTTACCATCCCACAACGCCGCCGTTATGCTCTTGACTAAAGACAGAGTTGGGCACCTAAAACGTAGGCCTGCGCGAGCATTGACTCCACCATTGTCAGCTGATCTTTGTGCACAATCTAATGGGATTGGGGTCCGATAGGGCGCCAAAGGTAGAGCTACGCGACTCTGGCTAGAATCCATGTGCTGAGCCTGTTTTTGTAGTAGCCGCGCTAAAAGCATTGTCGAGGATCTTAGAGCAATCATGGTCAATCGGACGCAGGCTTCTCATGCGGGTACCTAAAATTGAGGTTCTCTGGCCGGACCCAACGGGTCTTGTCCACCAAATTAACGGTAGCAACTCACCTATTTTTGTTAGTTGATTATTGAATGCAAACTCGTTTTGCGCACTGAGCGCTCTGAGGTAGAAGGCTGCCGACCCAAACATCCCCTACTGAGTGGTCGCCCTACTAGAGCGAATGCGTGTGCCCTGCGAAACACGCCGCTACCACCATCATGACTGAGAACATATAGTGTGCAGTGCAATATTCGCTAGCCAAGGTATGAGACAACTTCTCCATGCCCTCGGCAAAACGTCGTTCAGACTCAAATTGTTAGCTCATCTCTCAAATCCTATCTACTCAGAGATTGATGTTCATGATTCGGCTCCAGTCTAGCTTAAAAGTCGAAGAGATCGATCGAACCGAGAGCGTAAAGGGATGCCGTAACGGGTGGATCTCCCAAATCTGTGAGTAACCCCGCGACGTCATGGGAGAAT\n>Rosalind_7033\nCGGGTTGCCTATGAGTCTGGGACAGCAGAATTTGTGGAAATGGCCTGATGCTACTGCGGCCCGAAAACAGCGGAGTAAGATGGCGTGGCCCCTCATCCGACAGCAGGTCCCCGAACACGGAATCTGACGTTGAAACGCTAATTTACCATTTAGAGATAACGCTCGTAACGGGTAATAGGGGCAAATCGAACGCAACGTCGAATTACCCGCCGTGTTGTTCCGACTATCATAACGTACTCACTCAAGGATCGCCAATGCCCTCCAGTATGTTTTTACAGCATGTGGTGGCTAGCATCGTCAGTTCATCAGACACCTTTCGGCGGGGATTTCCGATTTGATGTGGTCCGACATGCAGTCGGGCGTATGAACTGCATTAGGTAGAAAAGGCTCCTTGCGACATCTGAAGACTACTGCAAGCATCCGCCAACCTTGGTACTCAAGCGCCGCTAAGACGCCTCTATTCGGGCGATTGGGGTTGCAGTAGACGCGGTTTGGGACATTGCGACGGAACCCATAGGCCTTCGAGAAGAAGCCGGGTCCCGTTTTCATGTAGCTGTGGGTCCCTTACATTGTGTCATTTGAGTGCATTTGTCGTTAGAAGTAACCTACCGGGCCGAAACTAGCCGGAATCTTGATCGCGGATTCACGGCCCCCTGAACCATATAGTACAAAACGACGGTAATTTAGCTAATTGGAATGAAACAACGACCGTTCCACTCTGAGCGTCACCAAGGTACCCGAACGGTTGGATATGTTGACGTTAAGGACGGAAGGACGGCCTCCGGATTCTATATTTATGAGTAGTACCAAGACACCTGGCAGCGCGACCTGGGCTTAATCCACCTAAAACCCAGCTGGGATTTTTATCGGGCTCTATCTGGGAGTATTGTCCTCAATTCATTTTCCCGAAAGATTAGTGGGTCTAGGTGGACATAATATATGACACCAGCCAACCAACCAACAACGTTTGTTACTGGGCCACA\n>Rosalind_6127\nGCTACTCCGATTGTGTATCACTGCCCCTCCTAGCGGGGGCGGGGTCGTGGTCATCATCGCTGCTTGGCACGCAATTCACCGCGCCCGAACCCGAATAGCCGCCCTCACCCCGTGCCCCATAACGCTAGGTACGTGGGACCGAAATAGCCTGATTAGAATAAGAGACATTTATAGTGATTCATCCAGGGTTACTAGAAGTGTGGCTATACTGCTCCCCGCTCCATCATTGTTACCTAGGAAACGCGGGGACCTTATGTGGTGATGGTTCCTCTACACAGGCCTACCTGTTCAACGCCTTGGTTTGGCAAGTAGGCTTTTCCTTGCAATTGCGCTGTGCGCAAGCCTTGCCGCTGAAATGAAGATACATTTGACCATCGCAGGAGTTCTGGCCGCTCACACGTATGCAAGTCGTCAATGCCATCCAAGGACTGGTATACACGCCTAAACTCCTGTAAACATGACACTACAACACGTGCTGAGTTAGCTAGGTCTGCTCGCTCCGATCGGGAGTGAAGAAAAACTGTTTACCCACGTAGCCAAGTTCTACCATTAAATCGGTAAGTGACAAGCTGTGATAGGCCAAGGACTCTACCAGAGCCTTGTTGGTCTTCTCTACCGTTGGCCTCTGTCCCCATTCTTTCTCTGTCCTGACGTGAAACGCCCTCCGCTTAGACTTAACGCATTAAGACTTCGGAGAGTTGTGTCGGGGCGGGGCCATCACATGGTTTATCCAAGTCAGGAACATGGCGGTGTGGCTATCCGCACCACGTAGCCACAACACACCAAGCTACTTCCTGAGCAGGGAGCCGTTCCGATCGACGACACTAGATGGGTCCTTGGTTAAAAGCCAGGGCGTGTAAGGTGGTCGAACCCGCTGCCGACTCACTTGTCCATATATACAACTCTTCTCCGGGAGATTTCCGTCTGTGCGATTAGCTGAGTGTGCTACCGGTCTACGCAATCCGAGGCTAGGAAGTTTATTG\n>Rosalind_3082\nTACTGAAAGTGTACTTAAAGTAGCTACAGAAAATCCCCCAAGAACTCGGTTAACTGTCGGTCCGTGTAAGTGTACGGAGGTTTCGACGGCCCCCATTGCCTACTGCCTGGGCCACTAGGGATGACTTGTCCGCTCACCTTCATAATCGATGTTACTTCGGTAACAAGCGAGGGGGGCGTCCAAAGCTGCCACTATCGTGCCTGCTTCGTCGTTAGGGGGTCGGGTAGGGAGTTCTCCAAAAGCGTGGGCGCACGGCTGGTCTCAGTGCGGTTGCAGCACATCAACTGCCTATACCACATTTAAGCTGGCCACACTGGTTATCGCGTGGACTTACTTGACTTGAAATTCTACCCGTGTCGAGTTGCCGTGATGCAAGGGCGGCGAAAACTAACCGCTAGTATGCCATCGAGCCTTTACCAACAGGAACTCCCAAGGGATCGACAGATGTCAAGCAACAGCTGTGTCAACTGGTAAACTTCTTGACCGCCTATGTTGTAAGAATGGTTCGTGATAGGGGTCTGAGCGAGCTAGGCTTAGTCAAAGTAACAGCCCGAACCCTTACGATGAGTTGATGATGCGTGTCGACGTCTAGGCCGGAGCATGACTGCCGCAGTGTGGGCCGACTGTTAGGAGTTATGTACCATGCCGTCATATGGTGTGTCTGTGGTCGTCCCAAACTCAGGCATGAAATCCATATTCGGGGTGCGATCACGGACCTCAGGGTTTGACCCTACCGATGGAAGATAAGTCGCGCTCTAAATGCCCATAACCATCACAACGAGAACGTCAAATTCTGCTTGATAGTCAGCGGATCAAACACGATATCACAATGTACGTCCATTTCAATATTGCCTTGTCAGTCGCAGTTGCGAATCCATATATGTGCGTTTCCCTCGTCGAGTTTTCTGATGGTCCTTGCTGGACACAGCGTAACACTCGCACTGATAGAAGGCAAGGTAAGCGACCGCACTATCTGCAGCTTT\n>Rosalind_6237\nATCCGGGAACTTTAATCGGATGCGGAGATCGTGCGATGCAAGCTGACCCACTGTGGAGCCCTTGTCGATCAATTCCGCGCCCTCAAACCGTATGGACGCACCCGCTCTCGACGAAATTCTTCAATCGTCCGTAGTTATACCCGTTGGGAAGAGCTTTAGGTGCGTGTGCTAGACCTACGACCGTAAGATCACCGAGATTGTAAGTGCACTGGCGCTGTACGTCGTAGGATCGAACGTACCTCAGCAGTCAACCCTAAACTTTAGAGTACTTTACTGAGTTCCTGACTGGGTGTATCTAAGCGTACATTCTTTACGTGGTGCACCGCGAGAGTTGGATTAGCGATAGCCCTTAATTTCCATGAAGAACCATGACGGCGAGATCGCGCTTAGGAACCGTTGCTCTTTGTGAGAGCTAGCTAGCTTCCTAGCCAGATAATGGTTTTGCCAGATCACCGCGCTCCGCCAATTCTGGCTATAGAAAAAGGGACCAGACGTGGATACCCACCTCATGCACCGGTGTTGAGTGTGCACCTGCACGTAGCGCTAATCAAATACGCGTCTGGGGGCATTTAGCCAGACGGCACCAGAACCTGCCACACTACATTCAGCTGCTACATATGAAGGCGGCCGCAGTGCATACGTAAAACATTCAAGTCGTGAAGCCTGTCGCATTTCTGCCCTTCAGAGACCGAAGGTTCAAAGAGCGTCAAACCTGCAATCCAGTTTAGGTAGAACTACACGTGCGCGAGGACGTTCATACTTCACCCAAGCACGGTCCAGGAAGCGTCCTCCCGTCGCGAAATGACGGCTCGAGGGACTGGCTCGCGTGGTAATCGTGTAGGCTCGTTTACTCAAGCCAGTAAAAGTACTTTGGATGGGATCATCTAAAAATCGATTAGCATGACTCGAAACAACTGGCGGACCCCGGCTTGTAGTGGATCCCTTGGCTCATCAGATTTTTTGCATTAGGCGAAAGAGATCCG\n>Rosalind_2042\nTATTGGATCCCAGTCTTTTTATCAGCGAGTTTATAAGGCACATTAGACGGGCGAGTAAGGGTACGAATACCGATGAAAAGGATTGAGCAGTTCTGTACATGGGAATGATAGGATTGCCAGGCAATTCGTGCTGTAGCAATGACACACCAGTTCGGACGTCCGCCGCATCCCTGAAGAGTAAGCTTCTAGACGATCATCCTGCCCCTAGAATCGACTGGTCATCAACCGTCCAGAGCGCCTTAAACCCTTTTGTAACGGCGACGATAAGCTGAGAAGTAGGTCGCAATCGACTAGCCGTTTAGCTCGATGGCGGGTTTAGTATTTACATGGGCCCGGCATTTCTCGAAGCGTATACACCCTTCCTCAGCAGCGGGTATGACATACCGTGAGTGTAAGACTGATGTAGTCCGCCGTATTCCAGTTACTCAACCAATTTCGACGGTCTAGAAATATCTAAGATCAGATAAGGGTAGACACGACAGGCGTTATCAAGCTCGGGGAGCTTAATGATCCATCATGTGTAGTTTACGCGAAGGGTACCTTACGACATCTTTACTACAGTGCTACAAAGTACCGGCGAGAGTAGAAGGCAAACCGATATTTTAATCGATAGTATTGCAGCGGAGTCATCTAAAATGTGTACCCTTAGACTAGGGAATGTCGTTGGGATATGAATGAGACTTCACAGTCTATTGTATGCGCAGAGCTCGCTTACCGACACCGCATAGAGCAGGCCGCAGGACATAGCACCGGGAGGCATCAAAGTGTGAGGTAAACACTGCACGGTTAGCTTCCGGACCCTCCAGTCTAAATCCACGCGCCAACAAAAACGGTGTTCGACCCACCAATTATCTTACAAATTCTCACTGTTAATCCCCGCATACAGTAGCTGTGCCCCACAACAGCGTAAATCCACCCGACGTAATTGTTCTCTTGTCACTGGTTAAAGAGAGGGATCCGTCAGCCAAAACGTTGTATTCAAT\n>Rosalind_3977\nGCCTCGAATTGTATGCGCTTCTCCGGCCAATCTTGTAAACTCCTCGGGGACTGAAGAATCACGAGATTCCCTAGTCGTAATTTCGACAGATTAGGCCGTCTTCGAGGGGACGCTGCATACATATAGTGCTCACTGGTCAACACCGTTTCGTCAACATATTTTTAAAGCTTTGGTCAGATTTATGAAACCCCGTGGCAACGCGACTTGGTCGTCTTTTGTAAATTATCGTCACGAGGCGAACATCTGGAATGTCGTCGATGTAGCGAGCCGACCCGTGTTACGGAACGAAGAGTCCCTATTGATGCGTGGCATAGGATAGCGTGTAACGTTCAGCTCGGGGGCCCGTGACGGTTGAGTGCCAGAAGAAGGTCACTATCGAGTTCACGATAACCGTGCTTGCGGATAATTTATGCTGTATCGCAAGGCCCTGGAAGGCGACCCCGGATTGCAGTACGTGTTTCTGTGCGGGGAACTAGTTAGCGCCAGGCAACGTCACTATAGCCCTTATTTTCATAGCTCTGCAAAGACTAACCCTGAGGCAAAGTCCTCAGAAGTTACCGGGTGCTGGCTTACTCACAGAAGAGAGGCCCCTCCTGTCCGCCTTGGAAACGTCATGGAGCTGGGGGAGGTGAGCACGGCCATGACGTCGTGGTTACAATGAGCTAGACTGTTCGGGTCGGGATTGCGAGCGGCTAGTTACGCTCTACAGTGGGACTACATGCCCTTATCGGGCTATCTAGTAAGTTACTGGGGACGTCCTGGGGAATGCCGGCCACAACATTGGTTTGCCAATCTCTGATGCGTAGACGAATCTTACTTCTGGTATTGGTACGAGAGTCGTCTCTCCTTACCAGTCGGAAAATGGATAATGACTAAACTGGGGGCGGCCCACATAGGCATACTATTGGCGCGCGTGTCACGAGACGTTTATGACGACTCACTACACATGAACCACCGAGGAATTATGAGTTGACACTCAAATT\n>Rosalind_2273\nCGTTAGACCCTGCCACACCCGGAAATATGCAGGCTCATCGCGTACCAAAAGTGAAGAATTGGGCTTTAATACAACTGCATTAAGCGCGGCCTTCAATCATGTGGAAGTGCTCGTGTGGATATACTATCTTCCTTGACCGAAAAGGTTCGGACCGGAAAGGTCCGCACTCCGCAAGAAGCCCTGTCCTTGCGTTGCGCCCTGCATGATAAAGAGAGAGAGTATTAAATATCGGTACTTCCGTGGAGGACATTGAGCACAAGCTTTAGGTCTCTAATTGTTAGCAGCAGGCCGAAGGTAAGACAAGTAAAGGTTGATACTACTGACTGTTGAACTGCACATCATTAGACACATAATGCTTCCTTCATACTGCGGGACTCAGAGAGTCACCCTGATCCAGCGGCATCTTAAGAACAGGTTACGCGTTGACAGTCCTCGTTCGTGCCGATCATAAGTTCTCGGTAATGGACCCGGCCACGTTGGTCATGTAAACCGGCCTGCCGAGGCATGGCTGTCTCAATTATTCACTATCCCCTTTCAGCATCGATACGGAAGTCTTTCGATGATGTAGTCTCTTAGTTCTCTCCCTCTTAAAATCTGTGTGTGACGCTGGGAATGTCTAGATGAATTCGAGGTCATTTTCTTCTACTGGTTGCCGCTGGTCGTACTCGCGTAAAGTCAGCACGGCGATCTCTTCGCCGGGGGGGTTATTGCGAAGGTCGTCTCTTGGACTGATACATTTACGGGCTCAACCAATCGTACGAAATCTTGAACGAAGAGGGTAGCCCCTGGATGGTTAGCACATTGGACATAATAACTGGTGTAGAATCACCTTCTTAATTTGAACCACAATAGCCCTTGTCAGAATGCGGGCTTTAGACCCAGGATGTTCACGTGCGGCGAATGTAGCTATCCCCATTGGGGCTGATTCTTTCCGGCGACTCTAAATTACCAAAACAACACGACCTACACCGTGTGGGAACAAG"

#Even indexed elements are ID whereas the odd ones are the sequences
splitted_string = string.split("\n")

dna_strings_matrix = []

#Matrix is created
for sequence in splitted_string[1::2]:
    dna_strings_matrix.append(sequence)
#Dictionaries are for getting rid of unnecessary if statements
base_to_index_dict = {'A': 0, 'C': 1, 'G': 2, 'T': 3}
index_to_base_dict = {0: 'A', 1:'C', 2:'G', 3:'T' }

#length of the each sequence and Number of FASTA formatted DNA is assigned respectively
n,k = len(dna_strings_matrix[0]), len(dna_strings_matrix)

#List that holds the number of A,C,T,G for every coloumn
big_list = []
#For every coloumn we look for each row and calculate the number of A,C,T,G
for col_index in range(n):
    number_of_bases = [0,0,0,0]
    for row_index in range(k):
        base = dna_strings_matrix[row_index][col_index]
        number_of_bases[base_to_index_dict[base]] += 1
    big_list.append(number_of_bases)

#Here is a method that finds the position of the maximum number in a list
def index_of_maximum_value(a_list):
    maximum, maximum_i = 0,0
    for i in range(len(a_list)):
        if(a_list[i] > maximum):
            maximum = a_list[i]
            maximum_i = i
    return maximum_i

#Maximum number in each row in the list will give us the most frequent base for a coloumn
for row in big_list:
    print(index_to_base_dict[index_of_maximum_value(row)],end = '')
print(end = '\n')

#Finally we will print out the profile
#Note that the transpose of the big_list is printed out below
for col_index in range(4):
    print(index_to_base_dict[col_index] + ":", end=' ')
    for row_index in range(n):
        print(big_list[row_index][col_index], end=' ')
    print(end = '\n')
